<%- include("../partials/header.ejs") %>
<%- include("../partials/navbar.ejs") %>

<div class="container">
    
    <div class="row">

        <div class="col col-12 mb-5">
            <div class="setup-user">
                <div class="fundo-user">
                    <div class="img-user-background">
                        aqui vai imagem de fundo
                    </div>
                </div>
                <div class="img-user">
                    <p>Aqui vai a imagem do meliante</p>
                </div>

            </div>
            <div class="info-user">
                <div class="nick">
                    <%= userFound.nick %>
                </div>
                <div class="friend">
                    Seguidores: <%= countAmizades.followers %>
                </div>
                <div class="friend">
                    Seguindo: <%= countAmizades.following %>
                </div>
                <div class="btn-follow">
                    <% if(user.id != userFound.id){ %>
                        <% if(amigos){ %>
                            <form action="/unfollow" method="post">
                                <input type="hidden" name="friendId" value="<%= userFound.id %>">
                                <input type="hidden" name="friendNick" value="<%= userFound.nick %>">
                                <button class="btn btn-primary">UNFOLLOW</button>
                            </form>
                        <% }else{ %>
                            <form action="/follow" method="post">
                                <input type="hidden" name="friendId" value="<%= userFound.id %>">
                                <input type="hidden" name="friendNick" value="<%= userFound.nick %>">
                                <button class="btn btn-primary">SEGUIR</button>
                            </form>
                        <% } %>
                    <% } %>

                    <% if(user.id == userFound.id){ %>
                        <button class="btn btn-primary">CONFIGURACAO</button>
                    <% } %>
                </div>

            </div>

        </div>
    
        <div class="col col-12 col-sm-10">
    
            <div class="conteudos" style="box-shadow: rgba(0, 0, 0, 0.116) 1px 8px 24px;">
        
                <% conteudos.forEach(conteudo=>{ %>

                    <% if(conteudo != null){ %>
                        <div class="post card">
                            <div class="post-header">
                                    <a class="link-info" href="/u/<%= conteudo.user.nick %>"><%= conteudo.user.nick %></a>
                            </div>
                            <div class="post-body">
                                <p><%= conteudo.body %></p>
                            </div>
                            <div class="post-footer">
                            <input id="conteudoId" type="hidden" value="<%= conteudo.id %>">
                            <input id="userId" type="hidden" value="<%= user.id %>">
                            <% if(!conteudo.likes.findIndex((like) => like.userId == user.id)){ %>
                                <button class="btn btn-sm btn-outline-danger" onclick="unLike(<%= conteudo.id %>, <%= user.id %>, this)">Deslike</button> 
                            <% }else{ %>
                                <button class="btn btn-sm btn-outline-danger" onclick="like(<%= conteudo.id %>, <%= user.id %>, this)">Like</button> 
                            <% } %>
                            <button id="amountLike<%= conteudo.id %>" class="btn" disabled><%= conteudo.likes.length %></button>
                            <button class="btn btn-sm btn-outline-danger">Comentar</button> 
                            </div>
                        </div>
                    <% } %>
                
                <% }) %>
        
                
                
                
            </div>
            
        </div>

        <%- include("../components/home/lateralHome") %>

    </div>

</div>



<%- include("../partials/footer") %>